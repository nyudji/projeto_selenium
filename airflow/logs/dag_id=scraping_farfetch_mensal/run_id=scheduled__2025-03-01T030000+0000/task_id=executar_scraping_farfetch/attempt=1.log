[2025-04-10T09:24:35.650+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-04-10T09:24:35.671+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [queued]>
[2025-04-10T09:24:35.676+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [queued]>
[2025-04-10T09:24:35.677+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 2
[2025-04-10T09:24:35.689+0000] {taskinstance.py:2890} INFO - Executing <Task(PythonOperator): executar_scraping_farfetch> on 2025-03-01 03:00:00+00:00
[2025-04-10T09:24:35.695+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=57) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-04-10T09:24:35.701+0000] {standard_task_runner.py:72} INFO - Started process 62 to run task
[2025-04-10T09:24:35.699+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'scraping_farfetch_mensal', 'executar_scraping_farfetch', 'scheduled__2025-03-01T03:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag_scraping.py', '--cfg-path', '/tmp/tmpswq1n5ar']
[2025-04-10T09:24:35.707+0000] {standard_task_runner.py:105} INFO - Job 2: Subtask executar_scraping_farfetch
[2025-04-10T09:24:35.810+0000] {task_command.py:467} INFO - Running <TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [running]> on host 75a9a64eb6d8
[2025-04-10T09:24:35.941+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='nicolas' AIRFLOW_CTX_DAG_ID='scraping_farfetch_mensal' AIRFLOW_CTX_TASK_ID='executar_scraping_farfetch' AIRFLOW_CTX_EXECUTION_DATE='2025-03-01T03:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-03-01T03:00:00+00:00'
[2025-04-10T09:24:35.944+0000] {taskinstance.py:732} INFO - ::endgroup::
[2025-04-10T09:25:16.274+0000] {job.py:229} INFO - Heartbeat recovered after 12.76 seconds
[2025-04-10T09:25:16.595+0000] {scrapping.py:26} INFO - Acessando o link: https://www.farfetch.com/br/shopping/men/items.aspx
[2025-04-10T09:25:22.557+0000] {job.py:229} INFO - Heartbeat recovered after 11.85 seconds
[2025-04-10T09:25:26.544+0000] {scrapping.py:39} WARNING - Erro ao clicar em Jaquetas (tentando novamente): Message: Element <span class="ltr-mnzq4b ewmv8150"> is not clickable at point (74,525) because another element <span class="ltr-4y8w0i-Body"> obscures it
Stacktrace:
RemoteError@chrome://remote/content/shared/RemoteError.sys.mjs:8:8
WebDriverError@chrome://remote/content/shared/webdriver/Errors.sys.mjs:193:5
ElementClickInterceptedError@chrome://remote/content/shared/webdriver/Errors.sys.mjs:337:5
webdriverClickElement@chrome://remote/content/marionette/interaction.sys.mjs:177:11
interaction.clickElement@chrome://remote/content/marionette/interaction.sys.mjs:136:11
clickElement@chrome://remote/content/marionette/actors/MarionetteCommandsChild.sys.mjs:205:29
receiveMessage@chrome://remote/content/marionette/actors/MarionetteCommandsChild.sys.mjs:85:31

[2025-04-10T09:25:52.085+0000] {scrapping.py:79} ERROR - Erro geral no scraping: Message: 
Stacktrace:
RemoteError@chrome://remote/content/shared/RemoteError.sys.mjs:8:8
WebDriverError@chrome://remote/content/shared/webdriver/Errors.sys.mjs:193:5
NoSuchElementError@chrome://remote/content/shared/webdriver/Errors.sys.mjs:511:5
dom.find/</<@chrome://remote/content/shared/DOM.sys.mjs:136:16

[2025-04-10T09:25:53.025+0000] {taskinstance.py:3313} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 768, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/scrapping.py", line 83, in run_scraping
    if not produtos_lista:
           ^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'produtos_lista' where it is not associated with a value
[2025-04-10T09:25:53.039+0000] {taskinstance.py:1226} INFO - Marking task as UP_FOR_RETRY. dag_id=scraping_farfetch_mensal, task_id=executar_scraping_farfetch, run_id=scheduled__2025-03-01T03:00:00+00:00, execution_date=20250301T030000, start_date=20250410T092435, end_date=20250410T092553
[2025-04-10T09:25:53.067+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-04-10T09:25:53.068+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 2 for task executar_scraping_farfetch (cannot access local variable 'produtos_lista' where it is not associated with a value; 62)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3006, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 274, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3161, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3185, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 768, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/scrapping.py", line 83, in run_scraping
    if not produtos_lista:
           ^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'produtos_lista' where it is not associated with a value
[2025-04-10T09:25:53.094+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2025-04-10T09:25:53.111+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-04-10T09:25:53.115+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-04-13T01:32:04.846+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-04-13T01:32:04.866+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [queued]>
[2025-04-13T01:32:04.873+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [queued]>
[2025-04-13T01:32:04.874+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 2
[2025-04-13T01:32:04.893+0000] {taskinstance.py:2890} INFO - Executing <Task(PythonOperator): executar_scraping_farfetch> on 2025-03-01 03:00:00+00:00
[2025-04-13T01:32:04.903+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=56) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-04-13T01:32:04.905+0000] {standard_task_runner.py:72} INFO - Started process 60 to run task
[2025-04-13T01:32:04.905+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'scraping_farfetch_mensal', 'executar_scraping_farfetch', 'scheduled__2025-03-01T03:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag_scraping.py', '--cfg-path', '/tmp/tmpus_10fb4']
[2025-04-13T01:32:04.907+0000] {standard_task_runner.py:105} INFO - Job 2: Subtask executar_scraping_farfetch
[2025-04-13T01:32:04.957+0000] {task_command.py:467} INFO - Running <TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [running]> on host 83b21d5a5ce3
[2025-04-13T01:32:05.102+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='nicolas' AIRFLOW_CTX_DAG_ID='scraping_farfetch_mensal' AIRFLOW_CTX_TASK_ID='executar_scraping_farfetch' AIRFLOW_CTX_EXECUTION_DATE='2025-03-01T03:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-03-01T03:00:00+00:00'
[2025-04-13T01:32:05.103+0000] {taskinstance.py:732} INFO - ::endgroup::
[2025-04-13T01:32:30.834+0000] {scrapping.py:35} INFO - Acessando o link: https://www.farfetch.com/br/shopping/men/items.aspx
[2025-04-13T01:32:40.258+0000] {scrapping.py:54} INFO - Clicou no menu de Jaquetas via JavaScript
[2025-04-13T01:32:51.405+0000] {scrapping.py:76} INFO - Total de produtos: 96
[2025-04-13T01:32:52.522+0000] {scrapping.py:90} INFO - Produto 0 processado
[2025-04-13T01:32:53.598+0000] {scrapping.py:90} INFO - Produto 1 processado
[2025-04-13T01:32:54.628+0000] {scrapping.py:90} INFO - Produto 2 processado
[2025-04-13T01:32:55.653+0000] {scrapping.py:90} INFO - Produto 3 processado
[2025-04-13T01:32:56.679+0000] {scrapping.py:90} INFO - Produto 4 processado
[2025-04-13T01:32:57.704+0000] {scrapping.py:90} INFO - Produto 5 processado
[2025-04-13T01:32:58.731+0000] {scrapping.py:90} INFO - Produto 6 processado
[2025-04-13T01:32:59.766+0000] {scrapping.py:90} INFO - Produto 7 processado
[2025-04-13T01:33:00.792+0000] {scrapping.py:90} INFO - Produto 8 processado
[2025-04-13T01:33:01.827+0000] {scrapping.py:90} INFO - Produto 9 processado
[2025-04-13T01:33:02.853+0000] {scrapping.py:90} INFO - Produto 10 processado
[2025-04-13T01:33:03.884+0000] {scrapping.py:90} INFO - Produto 11 processado
[2025-04-13T01:33:04.914+0000] {scrapping.py:90} INFO - Produto 12 processado
[2025-04-13T01:33:05.956+0000] {scrapping.py:90} INFO - Produto 13 processado
[2025-04-13T01:33:06.983+0000] {scrapping.py:90} INFO - Produto 14 processado
[2025-04-13T01:33:08.006+0000] {scrapping.py:90} INFO - Produto 15 processado
[2025-04-13T01:33:09.030+0000] {scrapping.py:90} INFO - Produto 16 processado
[2025-04-13T01:30:17.174+0000] {scrapping.py:90} INFO - Produto 17 processado
[2025-04-13T01:33:11.743+0000] {scrapping.py:90} INFO - Produto 18 processado
[2025-04-13T01:33:12.770+0000] {scrapping.py:90} INFO - Produto 19 processado
[2025-04-13T01:33:13.796+0000] {scrapping.py:90} INFO - Produto 20 processado
[2025-04-13T01:33:14.824+0000] {scrapping.py:90} INFO - Produto 21 processado
[2025-04-13T01:33:15.849+0000] {scrapping.py:90} INFO - Produto 22 processado
[2025-04-13T01:33:16.874+0000] {scrapping.py:90} INFO - Produto 23 processado
[2025-04-13T01:33:17.897+0000] {scrapping.py:90} INFO - Produto 24 processado
[2025-04-13T01:33:18.924+0000] {scrapping.py:90} INFO - Produto 25 processado
[2025-04-13T01:33:19.946+0000] {scrapping.py:90} INFO - Produto 26 processado
[2025-04-13T01:33:20.970+0000] {scrapping.py:90} INFO - Produto 27 processado
[2025-04-13T01:33:21.995+0000] {scrapping.py:90} INFO - Produto 28 processado
[2025-04-13T01:33:23.035+0000] {scrapping.py:90} INFO - Produto 29 processado
[2025-04-13T01:33:24.072+0000] {scrapping.py:90} INFO - Produto 30 processado
[2025-04-13T01:33:25.097+0000] {scrapping.py:90} INFO - Produto 31 processado
[2025-04-13T01:33:26.123+0000] {scrapping.py:90} INFO - Produto 32 processado
[2025-04-13T01:33:27.159+0000] {scrapping.py:90} INFO - Produto 33 processado
[2025-04-13T01:33:28.185+0000] {scrapping.py:90} INFO - Produto 34 processado
[2025-04-13T01:33:29.207+0000] {scrapping.py:90} INFO - Produto 35 processado
[2025-04-13T01:33:30.230+0000] {scrapping.py:90} INFO - Produto 36 processado
[2025-04-13T01:33:31.257+0000] {scrapping.py:90} INFO - Produto 37 processado
[2025-04-13T01:33:32.285+0000] {scrapping.py:90} INFO - Produto 38 processado
[2025-04-13T01:33:33.311+0000] {scrapping.py:90} INFO - Produto 39 processado
[2025-04-13T01:33:34.335+0000] {scrapping.py:90} INFO - Produto 40 processado
[2025-04-13T01:33:35.357+0000] {scrapping.py:90} INFO - Produto 41 processado
[2025-04-13T01:33:36.380+0000] {scrapping.py:90} INFO - Produto 42 processado
[2025-04-13T01:33:37.402+0000] {scrapping.py:90} INFO - Produto 43 processado
[2025-04-13T01:33:38.424+0000] {scrapping.py:90} INFO - Produto 44 processado
[2025-04-13T01:33:39.447+0000] {scrapping.py:90} INFO - Produto 45 processado
[2025-04-13T01:33:40.469+0000] {scrapping.py:90} INFO - Produto 46 processado
[2025-04-13T01:33:42.673+0000] {scrapping.py:90} INFO - Produto 47 processado
[2025-04-13T01:33:43.698+0000] {scrapping.py:90} INFO - Produto 48 processado
[2025-04-13T01:33:44.724+0000] {scrapping.py:90} INFO - Produto 49 processado
[2025-04-13T01:33:45.750+0000] {scrapping.py:90} INFO - Produto 50 processado
[2025-04-13T01:33:46.774+0000] {scrapping.py:90} INFO - Produto 51 processado
[2025-04-13T01:33:47.799+0000] {scrapping.py:90} INFO - Produto 52 processado
[2025-04-13T01:33:48.822+0000] {scrapping.py:90} INFO - Produto 53 processado
[2025-04-13T01:33:49.854+0000] {scrapping.py:90} INFO - Produto 54 processado
[2025-04-13T01:33:50.878+0000] {scrapping.py:90} INFO - Produto 55 processado
[2025-04-13T01:33:51.901+0000] {scrapping.py:90} INFO - Produto 56 processado
[2025-04-13T01:33:52.924+0000] {scrapping.py:90} INFO - Produto 57 processado
[2025-04-13T01:33:53.948+0000] {scrapping.py:90} INFO - Produto 58 processado
[2025-04-13T01:33:54.972+0000] {scrapping.py:90} INFO - Produto 59 processado
[2025-04-13T01:33:55.996+0000] {scrapping.py:90} INFO - Produto 60 processado
[2025-04-13T01:33:57.024+0000] {scrapping.py:90} INFO - Produto 61 processado
[2025-04-13T01:33:58.050+0000] {scrapping.py:90} INFO - Produto 62 processado
[2025-04-13T01:33:59.072+0000] {scrapping.py:90} INFO - Produto 63 processado
[2025-04-13T01:34:00.095+0000] {scrapping.py:90} INFO - Produto 64 processado
[2025-04-13T01:34:01.117+0000] {scrapping.py:90} INFO - Produto 65 processado
[2025-04-13T01:34:02.140+0000] {scrapping.py:90} INFO - Produto 66 processado
[2025-04-13T01:34:03.172+0000] {scrapping.py:90} INFO - Produto 67 processado
[2025-04-13T01:34:04.197+0000] {scrapping.py:90} INFO - Produto 68 processado
[2025-04-13T01:34:05.223+0000] {scrapping.py:90} INFO - Produto 69 processado
[2025-04-13T01:34:06.245+0000] {scrapping.py:90} INFO - Produto 70 processado
[2025-04-13T01:34:07.268+0000] {scrapping.py:90} INFO - Produto 71 processado
[2025-04-13T01:34:08.294+0000] {scrapping.py:90} INFO - Produto 72 processado
[2025-04-13T01:34:09.315+0000] {scrapping.py:90} INFO - Produto 73 processado
[2025-04-13T01:34:10.337+0000] {scrapping.py:90} INFO - Produto 74 processado
[2025-04-13T01:34:11.357+0000] {scrapping.py:90} INFO - Produto 75 processado
[2025-04-13T01:34:13.379+0000] {scrapping.py:90} INFO - Produto 76 processado
[2025-04-13T01:34:14.401+0000] {scrapping.py:90} INFO - Produto 77 processado
[2025-04-13T01:34:15.436+0000] {scrapping.py:90} INFO - Produto 78 processado
[2025-04-13T01:34:16.459+0000] {scrapping.py:90} INFO - Produto 79 processado
[2025-04-13T01:34:17.485+0000] {scrapping.py:90} INFO - Produto 80 processado
[2025-04-13T01:34:18.509+0000] {scrapping.py:90} INFO - Produto 81 processado
[2025-04-13T01:34:19.534+0000] {scrapping.py:90} INFO - Produto 82 processado
[2025-04-13T01:34:20.560+0000] {scrapping.py:90} INFO - Produto 83 processado
[2025-04-13T01:34:21.585+0000] {scrapping.py:90} INFO - Produto 84 processado
[2025-04-13T01:34:22.608+0000] {scrapping.py:90} INFO - Produto 85 processado
[2025-04-13T01:34:23.634+0000] {scrapping.py:90} INFO - Produto 86 processado
[2025-04-13T01:34:24.657+0000] {scrapping.py:90} INFO - Produto 87 processado
[2025-04-13T01:34:25.682+0000] {scrapping.py:90} INFO - Produto 88 processado
[2025-04-13T01:34:26.708+0000] {scrapping.py:90} INFO - Produto 89 processado
[2025-04-13T01:34:27.734+0000] {scrapping.py:90} INFO - Produto 90 processado
[2025-04-13T01:34:28.756+0000] {scrapping.py:90} INFO - Produto 91 processado
[2025-04-13T01:34:29.782+0000] {scrapping.py:90} INFO - Produto 92 processado
[2025-04-13T01:34:30.805+0000] {scrapping.py:90} INFO - Produto 93 processado
[2025-04-13T01:34:31.833+0000] {scrapping.py:90} INFO - Produto 94 processado
[2025-04-13T01:34:32.856+0000] {scrapping.py:90} INFO - Produto 95 processado
[2025-04-13T01:34:36.549+0000] {scrapping.py:119} INFO - Dados salvos em: /opt/***/dados/bruto/promocoes_jaquetas_13042025.csv
[2025-04-13T01:34:36.550+0000] {scrapping.py:121} INFO - Iniciando tratamento...
[2025-04-13T01:34:36.567+0000] {tratamento.py:34} INFO - Arquivo mais recente encontrado: /opt/***/dados/bruto/promocoes_jaquetas_13042025.csv
[2025-04-13T01:34:39.312+0000] {taskinstance.py:3313} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 768, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/scrapping.py", line 125, in run_scraping
    salvar_dados(produtos_lista)
  File "/opt/airflow/scrapping.py", line 122, in salvar_dados
    tratamento()
  File "/opt/airflow/tratamento.py", line 39, in tratamento
    spark = SparkSession.builder.appName("Calcula desconto").getOrCreate()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/sql/session.py", line 228, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 392, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 146, in __init__
    self._do_init(master, appName, sparkHome, pyFiles, environment, batchSize, serializer,
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 209, in _do_init
    self._jsc = jsc or self._initialize_context(self._conf._jconf)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 329, in _initialize_context
    return self._jvm.JavaSparkContext(jconf)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/py4j/java_gateway.py", line 1585, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.
: java.lang.IllegalAccessError: class org.apache.spark.storage.StorageUtils$ (in unnamed module @0x2e39ef76) cannot access class sun.nio.ch.DirectBuffer (in module java.base) because module java.base does not export sun.nio.ch to unnamed module @0x2e39ef76
	at org.apache.spark.storage.StorageUtils$.<init>(StorageUtils.scala:213)
	at org.apache.spark.storage.StorageUtils$.<clinit>(StorageUtils.scala)
	at org.apache.spark.storage.BlockManagerMasterEndpoint.<init>(BlockManagerMasterEndpoint.scala:110)
	at org.apache.spark.SparkEnv$.$anonfun$create$9(SparkEnv.scala:348)
	at org.apache.spark.SparkEnv$.registerOrLookupEndpoint$1(SparkEnv.scala:287)
	at org.apache.spark.SparkEnv$.create(SparkEnv.scala:336)
	at org.apache.spark.SparkEnv$.createDriverEnv(SparkEnv.scala:191)
	at org.apache.spark.SparkContext.createSparkEnv(SparkContext.scala:277)
	at org.apache.spark.SparkContext.<init>(SparkContext.scala:460)
	at org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:238)
	at py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)
	at py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:840)

[2025-04-13T01:34:39.348+0000] {taskinstance.py:1226} INFO - Marking task as UP_FOR_RETRY. dag_id=scraping_farfetch_mensal, task_id=executar_scraping_farfetch, run_id=scheduled__2025-03-01T03:00:00+00:00, execution_date=20250301T030000, start_date=20250413T013204, end_date=20250413T013439
[2025-04-13T01:34:39.393+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-04-13T01:34:39.394+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 2 for task executar_scraping_farfetch (An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.
: java.lang.IllegalAccessError: class org.apache.spark.storage.StorageUtils$ (in unnamed module @0x2e39ef76) cannot access class sun.nio.ch.DirectBuffer (in module java.base) because module java.base does not export sun.nio.ch to unnamed module @0x2e39ef76
	at org.apache.spark.storage.StorageUtils$.<init>(StorageUtils.scala:213)
	at org.apache.spark.storage.StorageUtils$.<clinit>(StorageUtils.scala)
	at org.apache.spark.storage.BlockManagerMasterEndpoint.<init>(BlockManagerMasterEndpoint.scala:110)
	at org.apache.spark.SparkEnv$.$anonfun$create$9(SparkEnv.scala:348)
	at org.apache.spark.SparkEnv$.registerOrLookupEndpoint$1(SparkEnv.scala:287)
	at org.apache.spark.SparkEnv$.create(SparkEnv.scala:336)
	at org.apache.spark.SparkEnv$.createDriverEnv(SparkEnv.scala:191)
	at org.apache.spark.SparkContext.createSparkEnv(SparkContext.scala:277)
	at org.apache.spark.SparkContext.<init>(SparkContext.scala:460)
	at org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:238)
	at py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)
	at py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:840)
; 60)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3006, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 274, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3161, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3185, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 768, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/scrapping.py", line 125, in run_scraping
    salvar_dados(produtos_lista)
  File "/opt/airflow/scrapping.py", line 122, in salvar_dados
    tratamento()
  File "/opt/airflow/tratamento.py", line 39, in tratamento
    spark = SparkSession.builder.appName("Calcula desconto").getOrCreate()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/sql/session.py", line 228, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 392, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 146, in __init__
    self._do_init(master, appName, sparkHome, pyFiles, environment, batchSize, serializer,
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 209, in _do_init
    self._jsc = jsc or self._initialize_context(self._conf._jconf)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 329, in _initialize_context
    return self._jvm.JavaSparkContext(jconf)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/py4j/java_gateway.py", line 1585, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/py4j/protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.
: java.lang.IllegalAccessError: class org.apache.spark.storage.StorageUtils$ (in unnamed module @0x2e39ef76) cannot access class sun.nio.ch.DirectBuffer (in module java.base) because module java.base does not export sun.nio.ch to unnamed module @0x2e39ef76
	at org.apache.spark.storage.StorageUtils$.<init>(StorageUtils.scala:213)
	at org.apache.spark.storage.StorageUtils$.<clinit>(StorageUtils.scala)
	at org.apache.spark.storage.BlockManagerMasterEndpoint.<init>(BlockManagerMasterEndpoint.scala:110)
	at org.apache.spark.SparkEnv$.$anonfun$create$9(SparkEnv.scala:348)
	at org.apache.spark.SparkEnv$.registerOrLookupEndpoint$1(SparkEnv.scala:287)
	at org.apache.spark.SparkEnv$.create(SparkEnv.scala:336)
	at org.apache.spark.SparkEnv$.createDriverEnv(SparkEnv.scala:191)
	at org.apache.spark.SparkContext.createSparkEnv(SparkContext.scala:277)
	at org.apache.spark.SparkContext.<init>(SparkContext.scala:460)
	at org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:500)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:481)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:238)
	at py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)
	at py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:840)

[2025-04-13T01:34:39.412+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2025-04-13T01:34:39.436+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-04-13T01:34:39.439+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-04-17T13:03:48.260+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-04-17T13:03:48.275+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [queued]>
[2025-04-17T13:03:48.280+0000] {taskinstance.py:2614} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [queued]>
[2025-04-17T13:03:48.280+0000] {taskinstance.py:2867} INFO - Starting attempt 1 of 2
[2025-04-17T13:03:48.294+0000] {taskinstance.py:2890} INFO - Executing <Task(PythonOperator): executar_scraping_farfetch> on 2025-03-01 03:00:00+00:00
[2025-04-17T13:03:48.300+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=58) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-04-17T13:03:48.302+0000] {standard_task_runner.py:72} INFO - Started process 62 to run task
[2025-04-17T13:03:48.303+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'scraping_farfetch_mensal', 'executar_scraping_farfetch', 'scheduled__2025-03-01T03:00:00+00:00', '--job-id', '2', '--raw', '--subdir', 'DAGS_FOLDER/dag_scraping.py', '--cfg-path', '/tmp/tmp0z6e79mj']
[2025-04-17T13:03:48.305+0000] {standard_task_runner.py:105} INFO - Job 2: Subtask executar_scraping_farfetch
[2025-04-17T13:03:48.548+0000] {task_command.py:467} INFO - Running <TaskInstance: scraping_farfetch_mensal.executar_scraping_farfetch scheduled__2025-03-01T03:00:00+00:00 [running]> on host 4412fcfa1ed9
[2025-04-17T13:03:48.626+0000] {taskinstance.py:3134} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='nicolas' AIRFLOW_CTX_DAG_ID='scraping_farfetch_mensal' AIRFLOW_CTX_TASK_ID='executar_scraping_farfetch' AIRFLOW_CTX_EXECUTION_DATE='2025-03-01T03:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-03-01T03:00:00+00:00'
[2025-04-17T13:03:48.627+0000] {taskinstance.py:732} INFO - ::endgroup::
[2025-04-17T13:04:13.077+0000] {scrapping.py:35} INFO - Acessando o link: https://www.farfetch.com/br/shopping/men/items.aspx
[2025-04-17T13:04:21.884+0000] {scrapping.py:54} INFO - Clicou no menu de Jaquetas via JavaScript
[2025-04-17T13:04:30.357+0000] {scrapping.py:76} INFO - Total de produtos: 96
[2025-04-17T13:04:31.393+0000] {scrapping.py:90} INFO - Produto 0 processado
[2025-04-17T13:04:32.708+0000] {scrapping.py:90} INFO - Produto 1 processado
[2025-04-17T13:04:33.733+0000] {scrapping.py:90} INFO - Produto 2 processado
[2025-04-17T13:04:35.935+0000] {scrapping.py:90} INFO - Produto 3 processado
[2025-04-17T13:04:36.962+0000] {scrapping.py:90} INFO - Produto 4 processado
[2025-04-17T13:04:37.987+0000] {scrapping.py:90} INFO - Produto 5 processado
[2025-04-17T13:04:39.014+0000] {scrapping.py:90} INFO - Produto 6 processado
[2025-04-17T13:04:40.040+0000] {scrapping.py:90} INFO - Produto 7 processado
[2025-04-17T13:04:41.069+0000] {scrapping.py:90} INFO - Produto 8 processado
[2025-04-17T13:04:42.095+0000] {scrapping.py:90} INFO - Produto 9 processado
[2025-04-17T13:04:43.121+0000] {scrapping.py:90} INFO - Produto 10 processado
[2025-04-17T13:04:44.146+0000] {scrapping.py:90} INFO - Produto 11 processado
[2025-04-17T13:04:45.172+0000] {scrapping.py:90} INFO - Produto 12 processado
[2025-04-17T13:04:46.197+0000] {scrapping.py:90} INFO - Produto 13 processado
[2025-04-17T13:04:47.224+0000] {scrapping.py:90} INFO - Produto 14 processado
[2025-04-17T13:04:48.251+0000] {scrapping.py:90} INFO - Produto 15 processado
[2025-04-17T13:04:49.276+0000] {scrapping.py:90} INFO - Produto 16 processado
[2025-04-17T13:04:50.300+0000] {scrapping.py:90} INFO - Produto 17 processado
[2025-04-17T13:04:51.325+0000] {scrapping.py:90} INFO - Produto 18 processado
[2025-04-17T13:04:52.350+0000] {scrapping.py:90} INFO - Produto 19 processado
[2025-04-17T13:04:53.374+0000] {scrapping.py:90} INFO - Produto 20 processado
[2025-04-17T13:04:54.400+0000] {scrapping.py:90} INFO - Produto 21 processado
[2025-04-17T13:04:55.424+0000] {scrapping.py:90} INFO - Produto 22 processado
[2025-04-17T13:04:56.455+0000] {scrapping.py:90} INFO - Produto 23 processado
[2025-04-17T13:04:57.478+0000] {scrapping.py:90} INFO - Produto 24 processado
[2025-04-17T13:04:58.502+0000] {scrapping.py:90} INFO - Produto 25 processado
[2025-04-17T13:04:59.524+0000] {scrapping.py:90} INFO - Produto 26 processado
[2025-04-17T13:05:00.548+0000] {scrapping.py:90} INFO - Produto 27 processado
[2025-04-17T13:05:01.570+0000] {scrapping.py:90} INFO - Produto 28 processado
[2025-04-17T13:05:02.592+0000] {scrapping.py:90} INFO - Produto 29 processado
[2025-04-17T13:05:03.613+0000] {scrapping.py:90} INFO - Produto 30 processado
[2025-04-17T13:05:04.637+0000] {scrapping.py:90} INFO - Produto 31 processado
[2025-04-17T13:05:05.667+0000] {scrapping.py:90} INFO - Produto 32 processado
[2025-04-17T13:05:07.690+0000] {scrapping.py:90} INFO - Produto 33 processado
[2025-04-17T13:05:08.712+0000] {scrapping.py:90} INFO - Produto 34 processado
[2025-04-17T13:05:09.735+0000] {scrapping.py:90} INFO - Produto 35 processado
[2025-04-17T13:05:10.758+0000] {scrapping.py:90} INFO - Produto 36 processado
[2025-04-17T13:05:11.781+0000] {scrapping.py:90} INFO - Produto 37 processado
[2025-04-17T13:05:12.805+0000] {scrapping.py:90} INFO - Produto 38 processado
[2025-04-17T13:05:13.839+0000] {scrapping.py:90} INFO - Produto 39 processado
[2025-04-17T13:05:14.861+0000] {scrapping.py:90} INFO - Produto 40 processado
[2025-04-17T13:05:15.885+0000] {scrapping.py:90} INFO - Produto 41 processado
[2025-04-17T13:05:16.905+0000] {scrapping.py:90} INFO - Produto 42 processado
[2025-04-17T13:05:17.928+0000] {scrapping.py:90} INFO - Produto 43 processado
[2025-04-17T13:05:18.953+0000] {scrapping.py:90} INFO - Produto 44 processado
[2025-04-17T13:05:19.975+0000] {scrapping.py:90} INFO - Produto 45 processado
[2025-04-17T13:05:20.996+0000] {scrapping.py:90} INFO - Produto 46 processado
[2025-04-17T13:05:22.019+0000] {scrapping.py:90} INFO - Produto 47 processado
[2025-04-17T13:05:23.042+0000] {scrapping.py:90} INFO - Produto 48 processado
[2025-04-17T13:05:24.064+0000] {scrapping.py:90} INFO - Produto 49 processado
[2025-04-17T13:05:25.090+0000] {scrapping.py:90} INFO - Produto 50 processado
[2025-04-17T13:05:26.114+0000] {scrapping.py:90} INFO - Produto 51 processado
[2025-04-17T13:05:27.137+0000] {scrapping.py:90} INFO - Produto 52 processado
[2025-04-17T13:05:28.159+0000] {scrapping.py:90} INFO - Produto 53 processado
[2025-04-17T13:05:29.180+0000] {scrapping.py:90} INFO - Produto 54 processado
[2025-04-17T13:05:30.205+0000] {scrapping.py:90} INFO - Produto 55 processado
[2025-04-17T13:05:31.228+0000] {scrapping.py:90} INFO - Produto 56 processado
[2025-04-17T13:05:32.250+0000] {scrapping.py:90} INFO - Produto 57 processado
[2025-04-17T13:05:33.271+0000] {scrapping.py:90} INFO - Produto 58 processado
[2025-04-17T13:05:34.296+0000] {scrapping.py:90} INFO - Produto 59 processado
[2025-04-17T13:05:35.318+0000] {scrapping.py:90} INFO - Produto 60 processado
[2025-04-17T13:05:36.348+0000] {scrapping.py:90} INFO - Produto 61 processado
[2025-04-17T13:05:40.098+0000] {scrapping.py:90} INFO - Produto 62 processado
[2025-04-17T13:05:41.123+0000] {scrapping.py:90} INFO - Produto 63 processado
[2025-04-17T13:05:42.145+0000] {scrapping.py:90} INFO - Produto 64 processado
[2025-04-17T13:05:43.168+0000] {scrapping.py:90} INFO - Produto 65 processado
[2025-04-17T13:05:44.190+0000] {scrapping.py:90} INFO - Produto 66 processado
[2025-04-17T13:05:45.215+0000] {scrapping.py:90} INFO - Produto 67 processado
[2025-04-17T13:05:46.237+0000] {scrapping.py:90} INFO - Produto 68 processado
[2025-04-17T13:05:47.260+0000] {scrapping.py:90} INFO - Produto 69 processado
[2025-04-17T13:05:48.296+0000] {scrapping.py:90} INFO - Produto 70 processado
[2025-04-17T13:05:49.319+0000] {scrapping.py:90} INFO - Produto 71 processado
[2025-04-17T13:05:50.341+0000] {scrapping.py:90} INFO - Produto 72 processado
[2025-04-17T13:05:51.365+0000] {scrapping.py:90} INFO - Produto 73 processado
[2025-04-17T13:05:52.389+0000] {scrapping.py:90} INFO - Produto 74 processado
[2025-04-17T13:05:53.412+0000] {scrapping.py:90} INFO - Produto 75 processado
[2025-04-17T13:05:54.438+0000] {scrapping.py:90} INFO - Produto 76 processado
[2025-04-17T13:05:55.459+0000] {scrapping.py:90} INFO - Produto 77 processado
[2025-04-17T13:05:56.481+0000] {scrapping.py:90} INFO - Produto 78 processado
[2025-04-17T13:05:57.506+0000] {scrapping.py:90} INFO - Produto 79 processado
[2025-04-17T13:05:58.528+0000] {scrapping.py:90} INFO - Produto 80 processado
[2025-04-17T13:05:59.555+0000] {scrapping.py:90} INFO - Produto 81 processado
[2025-04-17T13:06:00.578+0000] {scrapping.py:90} INFO - Produto 82 processado
[2025-04-17T13:06:01.602+0000] {scrapping.py:90} INFO - Produto 83 processado
[2025-04-17T13:06:02.625+0000] {scrapping.py:90} INFO - Produto 84 processado
[2025-04-17T13:06:03.648+0000] {scrapping.py:90} INFO - Produto 85 processado
[2025-04-17T13:06:04.670+0000] {scrapping.py:90} INFO - Produto 86 processado
[2025-04-17T13:06:05.694+0000] {scrapping.py:90} INFO - Produto 87 processado
[2025-04-17T13:06:06.717+0000] {scrapping.py:90} INFO - Produto 88 processado
[2025-04-17T13:06:07.742+0000] {scrapping.py:90} INFO - Produto 89 processado
[2025-04-17T13:06:08.764+0000] {scrapping.py:90} INFO - Produto 90 processado
[2025-04-17T13:06:12.516+0000] {scrapping.py:90} INFO - Produto 91 processado
[2025-04-17T13:06:13.538+0000] {scrapping.py:90} INFO - Produto 92 processado
[2025-04-17T13:06:14.564+0000] {scrapping.py:90} INFO - Produto 93 processado
[2025-04-17T13:06:15.587+0000] {scrapping.py:90} INFO - Produto 94 processado
[2025-04-17T13:06:16.614+0000] {scrapping.py:90} INFO - Produto 95 processado
[2025-04-17T13:06:20.524+0000] {scrapping.py:119} INFO - Dados salvos em: /opt/***/dados/bruto/promocoes_jaquetas_17042025.csv
[2025-04-17T13:06:20.524+0000] {scrapping.py:121} INFO - Iniciando tratamento...
[2025-04-17T13:06:20.542+0000] {tratamento.py:34} INFO - Arquivo mais recente encontrado: /opt/***/dados/bruto/promocoes_jaquetas_17042025.csv
[2025-04-17T13:06:20.714+0000] {taskinstance.py:3313} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 768, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/scrapping.py", line 125, in run_scraping
    salvar_dados(produtos_lista)
  File "/opt/airflow/scrapping.py", line 122, in salvar_dados
    tratamento()
  File "/opt/airflow/tratamento.py", line 39, in tratamento
    spark = SparkSession.builder.appName("Calcula desconto").getOrCreate()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/sql/session.py", line 228, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 392, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 144, in __init__
    SparkContext._ensure_initialized(self, gateway=gateway, conf=conf)
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 339, in _ensure_initialized
    SparkContext._gateway = gateway or launch_gateway(conf)
                                       ^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/java_gateway.py", line 98, in launch_gateway
    proc = Popen(command, **popen_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/subprocess.py", line 1028, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/lib/python3.12/subprocess.py", line 1963, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/spark/./bin/spark-submit'
[2025-04-17T13:06:20.732+0000] {taskinstance.py:1226} INFO - Marking task as UP_FOR_RETRY. dag_id=scraping_farfetch_mensal, task_id=executar_scraping_farfetch, run_id=scheduled__2025-03-01T03:00:00+00:00, execution_date=20250301T030000, start_date=20250417T130348, end_date=20250417T130620
[2025-04-17T13:06:20.762+0000] {taskinstance.py:341} INFO - ::group::Post task execution logs
[2025-04-17T13:06:20.763+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 2 for task executar_scraping_farfetch ([Errno 2] No such file or directory: '/opt/spark/./bin/spark-submit'; 62)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 116, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3006, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 274, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3161, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3185, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 768, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 734, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 424, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/scrapping.py", line 125, in run_scraping
    salvar_dados(produtos_lista)
  File "/opt/airflow/scrapping.py", line 122, in salvar_dados
    tratamento()
  File "/opt/airflow/tratamento.py", line 39, in tratamento
    spark = SparkSession.builder.appName("Calcula desconto").getOrCreate()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/sql/session.py", line 228, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 392, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 144, in __init__
    SparkContext._ensure_initialized(self, gateway=gateway, conf=conf)
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/context.py", line 339, in _ensure_initialized
    SparkContext._gateway = gateway or launch_gateway(conf)
                                       ^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pyspark/java_gateway.py", line 98, in launch_gateway
    proc = Popen(command, **popen_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/subprocess.py", line 1028, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/usr/local/lib/python3.12/subprocess.py", line 1963, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: '/opt/spark/./bin/spark-submit'
[2025-04-17T13:07:49.990+0000] {job.py:229} INFO - Heartbeat recovered after 200.62 seconds
[2025-04-17T13:07:49.997+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2025-04-17T13:07:50.012+0000] {taskinstance.py:3901} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-04-17T13:07:50.017+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
